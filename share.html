<script>
  // urls: array já decodificada a partir do parâmetro data
  async function openAllViaExtension(urls){
    if(!urls || !urls.length) return alert('Nenhuma URL.');
    const extId = "EXTENSION_ID_REPLACE_AQUI"; // copiar do chrome://extensions/
    try {
      chrome.runtime.sendMessage(extId, { type: 'open_tabs', urls }, (resp) => {
        if(chrome.runtime.lastError){
          // provável que a extensão não esteja instalada ou não permita mensagem
          alert('Extensão não encontrada ou sem permissão para conectar. Por favor instale a extensão e tente novamente.');
        } else if (resp && resp.ok){
          alert('Solicitação enviada à extensão. As abas serão abertas.');
        } else {
          alert('Resposta da extensão: ' + (resp && resp.error ? resp.error : 'erro desconhecido'));
        }
      });
    } catch (e) {
      alert('Não foi possível enviar mensagem para a extensão: ' + e.message);
    }
  }
  // Exemplo de uso: quando usuário clicar no botão
  document.getElementById('openAllBtn').addEventListener('click', ()=> openAllViaExtension(urls));
</script>
